axis(1)
axis(2)
#text(25, 75, paste0('RMSE = ', round(dur_lm_rmse, 3)))
text(75, 21, paste0("tau = ", round(dur_kt[["estimate"]][["tau"]], 3)))
text(75, 14, paste0("p = ", round(dur_kt[["p.value"]], 3)))
abline(duration_lm)
dev.off()
png(file = paste0(here(), '/results/plots/phenology_estimates_10_90.png'),
width = 6, height = 6, pointsize = 4, units = 'cm', res = 300)
par(pty="s",mgp=c(2,1,0),  mfrow = c(2,2), mar = c(3,3,1,1))
plotCI(x = rd_start$DOY_obs,  rd_start$DOY_est,
li = rd_start$DOY_low, ui = rd_start$DOY_high,
pch=20, slty = 3, gap = 0.025, scol = 'grey70', sfrac = 0.0, col = 'grey40',
xlim = c(140,220), ylim = c(140,220), axes = F,
main = "First Flower Date",
xlab = "", ylab = "Estimated (DOY)")
axis(1)
axis(2)
text(155, 215, paste0("tau = ", round(start_kt[["estimate"]][["tau"]], 3)))
text(155, 209, "p < 0.001")
abline(start_lm, lty = 2)
plotCI(x = rd_peak$DOY_obs,  rd_peak$DOY_est,
li = rd_peak$DOY_low, ui = rd_peak$DOY_high,
pch = 20, slty = 3, gap = 0.025, scol = 'grey70', sfrac = 0.0,
xlim = c(160,240), ylim = c(160,240), axes = F,
main = "Peak Flower Date",
xlab = "", ylab = "Estimated (DOY)")
axis(1)
axis(2)
#text(175, 235, paste0('RMSE = ', round(peak_lm_rmse, 3)))
text(175, 235, paste0("tau = ", round(peak_kt[["estimate"]][["tau"]], 3)))
text(175, 229, "p < 0.001")
abline(peak_lm)
plotCI(x = rd_last$DOY_obs,  rd_last$DOY_est,
li = rd_last$DOY_low, ui = rd_last$DOY_high,
pch = 20, slty = 3, gap = 0.025, scol = 'grey70', sfrac = 0.0,
xlim = c(160,250), ylim = c(160,250), axes = F,
main = "Last Flower Date",
xlab = "Observed (DOY)", ylab = "Estimated (DOY)")
axis(1)
axis(2)
#text(175, 245, paste0('RMSE = ', round(last_lm_rmse, 3)))
text(235, 173, paste0("tau = ", round(end_kt[["estimate"]][["tau"]], 3)))
text(235, 165, "p < 0.001")
abline(last_lm)
plotCI(x = rd_dur$DOY_obs,  rd_dur$DOY_est,
li = rd_dur$DOY_low, ui = rd_dur$DOY_high,
pch = 20, slty = 3, gap = 0.025, scol = 'grey70', sfrac = 0.0,
xlim = c(10,90), ylim = c(10,90), axes = F,
main = "Duration",
xlab = "Observed (Days)", ylab = "Estimated (Days)")
axis(1)
axis(2)
#text(25, 75, paste0('RMSE = ', round(dur_lm_rmse, 3)))
text(75, 21, paste0("tau = ", round(dur_kt[["estimate"]][["tau"]], 3)))
text(75, 14, paste0("p = ", round(dur_kt[["p.value"]], 3)))
abline(duration_lm)
dev.off()
png(file = paste0(here(), '/results/plots/phenology_estimates_10_90.png'),
width = 6, height = 6, pointsize = 4, units = 'cm', res = 300)
par(pty="s",mgp=c(2,1,0),  mfrow = c(2,2), mar = c(3,3,1,1))
plotCI(x = rd_start$DOY_obs,  rd_start$DOY_est,
li = rd_start$DOY_low, ui = rd_start$DOY_high,
pch=20, slty = 3, gap = 0.025, scol = 'grey70', sfrac = 0.0, col = 'grey20',
xlim = c(140,220), ylim = c(140,220), axes = F,
main = "First Flower Date",
xlab = "", ylab = "Estimated (DOY)")
axis(1)
axis(2)
text(155, 215, paste0("tau = ", round(start_kt[["estimate"]][["tau"]], 3)))
text(155, 209, "p < 0.001")
abline(start_lm, lty = 2)
plotCI(x = rd_peak$DOY_obs,  rd_peak$DOY_est,
li = rd_peak$DOY_low, ui = rd_peak$DOY_high,
pch = 20, slty = 3, gap = 0.025, scol = 'grey70', sfrac = 0.0,
xlim = c(160,240), ylim = c(160,240), axes = F,
main = "Peak Flower Date",
xlab = "", ylab = "Estimated (DOY)")
axis(1)
axis(2)
#text(175, 235, paste0('RMSE = ', round(peak_lm_rmse, 3)))
text(175, 235, paste0("tau = ", round(peak_kt[["estimate"]][["tau"]], 3)))
text(175, 229, "p < 0.001")
abline(peak_lm)
plotCI(x = rd_last$DOY_obs,  rd_last$DOY_est,
li = rd_last$DOY_low, ui = rd_last$DOY_high,
pch = 20, slty = 3, gap = 0.025, scol = 'grey70', sfrac = 0.0,
xlim = c(160,250), ylim = c(160,250), axes = F,
main = "Last Flower Date",
xlab = "Observed (DOY)", ylab = "Estimated (DOY)")
axis(1)
axis(2)
#text(175, 245, paste0('RMSE = ', round(last_lm_rmse, 3)))
text(235, 173, paste0("tau = ", round(end_kt[["estimate"]][["tau"]], 3)))
text(235, 165, "p < 0.001")
abline(last_lm)
plotCI(x = rd_dur$DOY_obs,  rd_dur$DOY_est,
li = rd_dur$DOY_low, ui = rd_dur$DOY_high,
pch = 20, slty = 3, gap = 0.025, scol = 'grey70', sfrac = 0.0,
xlim = c(10,90), ylim = c(10,90), axes = F,
main = "Duration",
xlab = "Observed (Days)", ylab = "Estimated (Days)")
axis(1)
axis(2)
#text(25, 75, paste0('RMSE = ', round(dur_lm_rmse, 3)))
text(75, 21, paste0("tau = ", round(dur_kt[["estimate"]][["tau"]], 3)))
text(75, 14, paste0("p = ", round(dur_kt[["p.value"]], 3)))
abline(duration_lm)
dev.off()
png(file = paste0(here(), '/results/plots/phenology_estimates_10_90.png'),
width = 6, height = 6, pointsize = 4, units = 'cm', res = 300)
par(pty="s",mgp=c(2,1,0),  mfrow = c(2,2), mar = c(3,3,1,1))
plotCI(x = rd_start$DOY_obs,  rd_start$DOY_est,
li = rd_start$DOY_low, ui = rd_start$DOY_high,
pch=20, slty = 3, gap = 0.025, scol = 'grey70', sfrac = 0.0, col = 'grey10',
xlim = c(140,220), ylim = c(140,220), axes = F,
main = "First Flower Date",
xlab = "", ylab = "Estimated (DOY)")
axis(1)
axis(2)
text(155, 215, paste0("tau = ", round(start_kt[["estimate"]][["tau"]], 3)))
text(155, 209, "p < 0.001")
abline(start_lm, lty = 2)
plotCI(x = rd_peak$DOY_obs,  rd_peak$DOY_est,
li = rd_peak$DOY_low, ui = rd_peak$DOY_high,
pch = 20, slty = 3, gap = 0.025, scol = 'grey70', sfrac = 0.0,
xlim = c(160,240), ylim = c(160,240), axes = F,
main = "Peak Flower Date",
xlab = "", ylab = "Estimated (DOY)")
axis(1)
axis(2)
#text(175, 235, paste0('RMSE = ', round(peak_lm_rmse, 3)))
text(175, 235, paste0("tau = ", round(peak_kt[["estimate"]][["tau"]], 3)))
text(175, 229, "p < 0.001")
abline(peak_lm)
plotCI(x = rd_last$DOY_obs,  rd_last$DOY_est,
li = rd_last$DOY_low, ui = rd_last$DOY_high,
pch = 20, slty = 3, gap = 0.025, scol = 'grey70', sfrac = 0.0,
xlim = c(160,250), ylim = c(160,250), axes = F,
main = "Last Flower Date",
xlab = "Observed (DOY)", ylab = "Estimated (DOY)")
axis(1)
axis(2)
#text(175, 245, paste0('RMSE = ', round(last_lm_rmse, 3)))
text(235, 173, paste0("tau = ", round(end_kt[["estimate"]][["tau"]], 3)))
text(235, 165, "p < 0.001")
abline(last_lm)
plotCI(x = rd_dur$DOY_obs,  rd_dur$DOY_est,
li = rd_dur$DOY_low, ui = rd_dur$DOY_high,
pch = 20, slty = 3, gap = 0.025, scol = 'grey70', sfrac = 0.0,
xlim = c(10,90), ylim = c(10,90), axes = F,
main = "Duration",
xlab = "Observed (Days)", ylab = "Estimated (Days)")
axis(1)
axis(2)
#text(25, 75, paste0('RMSE = ', round(dur_lm_rmse, 3)))
text(75, 21, paste0("tau = ", round(dur_kt[["estimate"]][["tau"]], 3)))
text(75, 14, paste0("p = ", round(dur_kt[["p.value"]], 3)))
abline(duration_lm)
dev.off()
png(file = paste0(here(), '/results/plots/phenology_estimates_10_90.png'),
width = 6, height = 6, pointsize = 4, units = 'cm', res = 300)
par(pty="s",mgp=c(2,1,0),  mfrow = c(2,2), mar = c(3,3,1,1))
plotCI(x = rd_start$DOY_obs,  rd_start$DOY_est,
li = rd_start$DOY_low, ui = rd_start$DOY_high,
pch=20, slty = 3, gap = 0.025, scol = 'grey70', sfrac = 0.0, col = 'grey15',
xlim = c(140,220), ylim = c(140,220), axes = F,
main = "First Flower Date",
xlab = "", ylab = "Estimated (DOY)")
axis(1)
axis(2)
text(155, 215, paste0("tau = ", round(start_kt[["estimate"]][["tau"]], 3)))
text(155, 209, "p < 0.001")
abline(start_lm, lty = 2)
plotCI(x = rd_peak$DOY_obs,  rd_peak$DOY_est,
li = rd_peak$DOY_low, ui = rd_peak$DOY_high,
pch = 20, slty = 3, gap = 0.025, scol = 'grey70', sfrac = 0.0,
xlim = c(160,240), ylim = c(160,240), axes = F,
main = "Peak Flower Date",
xlab = "", ylab = "Estimated (DOY)")
axis(1)
axis(2)
#text(175, 235, paste0('RMSE = ', round(peak_lm_rmse, 3)))
text(175, 235, paste0("tau = ", round(peak_kt[["estimate"]][["tau"]], 3)))
text(175, 229, "p < 0.001")
abline(peak_lm)
plotCI(x = rd_last$DOY_obs,  rd_last$DOY_est,
li = rd_last$DOY_low, ui = rd_last$DOY_high,
pch = 20, slty = 3, gap = 0.025, scol = 'grey70', sfrac = 0.0,
xlim = c(160,250), ylim = c(160,250), axes = F,
main = "Last Flower Date",
xlab = "Observed (DOY)", ylab = "Estimated (DOY)")
axis(1)
axis(2)
#text(175, 245, paste0('RMSE = ', round(last_lm_rmse, 3)))
text(235, 173, paste0("tau = ", round(end_kt[["estimate"]][["tau"]], 3)))
text(235, 165, "p < 0.001")
abline(last_lm)
plotCI(x = rd_dur$DOY_obs,  rd_dur$DOY_est,
li = rd_dur$DOY_low, ui = rd_dur$DOY_high,
pch = 20, slty = 3, gap = 0.025, scol = 'grey70', sfrac = 0.0,
xlim = c(10,90), ylim = c(10,90), axes = F,
main = "Duration",
xlab = "Observed (Days)", ylab = "Estimated (Days)")
axis(1)
axis(2)
#text(25, 75, paste0('RMSE = ', round(dur_lm_rmse, 3)))
text(75, 21, paste0("tau = ", round(dur_kt[["estimate"]][["tau"]], 3)))
text(75, 14, paste0("p = ", round(dur_kt[["p.value"]], 3)))
abline(duration_lm)
dev.off()
png(file = paste0(here(), '/results/plots/phenology_estimates_10_90.png'),
width = 6, height = 6, pointsize = 4, units = 'cm', res = 300)
par(pty="s",mgp=c(2,1,0),  mfrow = c(2,2), mar = c(3,3,1,1))
plotCI(x = rd_start$DOY_obs,  rd_start$DOY_est,
li = rd_start$DOY_low, ui = rd_start$DOY_high,
pch=20, slty = 3, gap = 0.025, scol = 'grey70', sfrac = 0.0, col = 'grey15',
xlim = c(140,220), ylim = c(140,220), axes = F,
main = "First Flower Date",
xlab = "", ylab = "Estimated (DOY)")
axis(1)
axis(2)
text(155, 215, paste0("tau = ", round(start_kt[["estimate"]][["tau"]], 3)))
text(155, 209, "p < 0.001")
abline(start_lm, lty = 2)
plotCI(x = rd_peak$DOY_obs,  rd_peak$DOY_est,
li = rd_peak$DOY_low, ui = rd_peak$DOY_high,
pch = 20, slty = 3, gap = 0.025, scol = 'grey70', sfrac = 0.0, col = 'grey15',
xlim = c(160,240), ylim = c(160,240), axes = F,
main = "Peak Flower Date",
xlab = "", ylab = "Estimated (DOY)")
axis(1)
axis(2)
#text(175, 235, paste0('RMSE = ', round(peak_lm_rmse, 3)))
text(175, 235, paste0("tau = ", round(peak_kt[["estimate"]][["tau"]], 3)))
text(175, 229, "p < 0.001")
abline(peak_lm)
plotCI(x = rd_last$DOY_obs,  rd_last$DOY_est,
li = rd_last$DOY_low, ui = rd_last$DOY_high,
pch = 20, slty = 3, gap = 0.025, scol = 'grey70', sfrac = 0.0, col = 'grey15',
xlim = c(160,250), ylim = c(160,250), axes = F,
main = "Last Flower Date",
xlab = "Observed (DOY)", ylab = "Estimated (DOY)")
axis(1)
axis(2)
#text(175, 245, paste0('RMSE = ', round(last_lm_rmse, 3)))
text(235, 173, paste0("tau = ", round(end_kt[["estimate"]][["tau"]], 3)))
text(235, 165, "p < 0.001")
abline(last_lm)
plotCI(x = rd_dur$DOY_obs,  rd_dur$DOY_est,
li = rd_dur$DOY_low, ui = rd_dur$DOY_high,
pch = 20, slty = 3, gap = 0.025, scol = 'grey70', sfrac = 0.0, col = 'grey15',
xlim = c(10,90), ylim = c(10,90), axes = F,
main = "Duration",
xlab = "Observed (Days)", ylab = "Estimated (Days)")
axis(1)
axis(2)
#text(25, 75, paste0('RMSE = ', round(dur_lm_rmse, 3)))
text(75, 21, paste0("tau = ", round(dur_kt[["estimate"]][["tau"]], 3)))
text(75, 14, paste0("p = ", round(dur_kt[["p.value"]], 3)))
abline(duration_lm)
dev.off()
png(file = paste0(here(), '/results/plots/phenology_estimates_10_90.png'),
width = 6, height = 6, pointsize = 4, units = 'cm', res = 300)
par(pty="s",mgp=c(2,1,0),  mfrow = c(2,2), mar = c(3,3,1,1))
plotCI(x = rd_start$DOY_obs,  rd_start$DOY_est,
li = rd_start$DOY_low, ui = rd_start$DOY_high,
pch=20, slty = 3, gap = 0.025, scol = 'grey70', sfrac = 0.0, col = 'grey15',
xlim = c(140,220), ylim = c(140,220), axes = F,
main = "First Flower Date",
xlab = "", ylab = "Estimated (DOY)")
axis(1)
axis(2)
text(155, 215, paste0("tau = ", round(start_kt[["estimate"]][["tau"]], 3)))
text(155, 209, "p < 0.001")
abline(start_lm, lty = 2)
plotCI(x = rd_peak$DOY_obs,  rd_peak$DOY_est,
li = rd_peak$DOY_low, ui = rd_peak$DOY_high,
pch = 20, slty = 3, gap = 0.025, scol = 'grey70', sfrac = 0.0, col = 'grey15',
xlim = c(160,240), ylim = c(160,240), axes = F,
main = "Peak Flower Date",
xlab = "", ylab = "Estimated (DOY)")
axis(1)
axis(2)
#text(175, 235, paste0('RMSE = ', round(peak_lm_rmse, 3)))
text(175, 235, paste0("tau = ", round(peak_kt[["estimate"]][["tau"]], 3)))
text(175, 229, "p < 0.001")
abline(peak_lm)
plotCI(x = rd_last$DOY_obs,  rd_last$DOY_est,
li = rd_last$DOY_low, ui = rd_last$DOY_high,
pch = 20, slty = 3, gap = 0.025, scol = 'grey70', sfrac = 0.0, col = 'grey15',
xlim = c(160,250), ylim = c(160,250), axes = F,
main = "Last Flower Date",
xlab = "Observed (DOY)", ylab = "Estimated (DOY)")
axis(1)
axis(2)
#text(175, 245, paste0('RMSE = ', round(last_lm_rmse, 3)))
text(235, 173, paste0("tau = ", round(end_kt[["estimate"]][["tau"]], 3)))
text(235, 165, "p < 0.001")
abline(last_lm)
plotCI(x = rd_dur$DOY_obs,  rd_dur$DOY_est,
li = rd_dur$DOY_low, ui = rd_dur$DOY_high,
pch = 20, slty = 3, gap = 0.025, scol = 'grey70', sfrac = 0.0, col = 'grey15',
xlim = c(10,90), ylim = c(10,90), axes = F,
main = "Duration",
xlab = "Observed (Days)", ylab = "Estimated (Days)")
axis(1)
axis(2)
#text(25, 75, paste0('RMSE = ', round(dur_lm_rmse, 3)))
text(75, 21, paste0("tau = ", round(dur_kt[["estimate"]][["tau"]], 3)))
text(75, 15, paste0("p = ", round(dur_kt[["p.value"]], 3)))
abline(duration_lm)
dev.off()
rm(rd_start, rd_peak, rd_last, rd_dur, groundTruth, weibull_estimates_test,
duration_lm, end_lm, last_lm, peak_lm, start_lm,
dur_lm_rmse, last_lm_rmse, peak_lm_rmse, start_lm_rmse,
dur_kt, end_kt, last_kt, peak_kt, start_kt)
knitr::opts_chunk$set(echo = TRUE)
library(sdm)
library(tidyverse) # data tidying
library(sf) # spatial data compliant with tidyverse
library(raster) # raster data
library(here)
source(here::here('scripts/sdm_functions.R'))
set.seed(12)
names_vec <- c('PCL_MAN','PCL_SE1','PCL_SE2','PCL_SE3','PCM_BFP','PCM_CMD',
'PCM_DD5', 'PCM_MAP','PCM_PAS','PCM_TD','PCT_ECO','PCT_EFW',
'PLC_HRB', 'PLC_TRE', 'PLC_URB', 'PSL_BDR', 'PSL_CAR',
'PSL_PHO', 'PSL_SND','PSL_TUS','PSL_TWL','PTP_ELV','PTP_RLV',
'PTP_SLP','PTP_WET','PTP_ASP','PTP_SOL', 'PCL_MRA','PSW_DIS',
'PSW_OCC','PCO_XSC', 'PCO_YSC')
WPDPV <- raster::stack("/hdd/Geospatial_data/Western_Plant_Predictors/SoRo_wppr_vers_two.tif")
names(WPDPV) <- names_vec
target <- c(2, 4,9, 10, 13, 14, 16, 19, 20, 23, 24, 25, 26, 27, 29, 30)
target_ml <- c(1:10, 13:14, 16:20, 22:30)
WPDPV2 <- WPDPV[[(target)]]
WPDPV1 <- WPDPV[[(target_ml)]]
geo_proj = crs(WPDPV)
rm(WPDPV, target, target_ml, names_vec)
rm(WPDPV1)
PA_ML_DF <- read_sf(here("data/processed/Pseudo_absences_ML_PREDICTED.shp"))
PA_ML_DF %>% pull(binomial) %>% unique()
PA_ML_DF1 <- split(PA_ML_DF, ~ binomial)
rm(PA_ML_DF)
Sys.time()
lapply(PA_ML_DF1, Machine_SDM) # skipped #3 & # 112
View(PA_ML_DF1)
sdm::installAll()
Sys.time()
lapply(PA_ML_DF1[1:15], Machine_SDM) # skipped #3 & # 112
Sys.time()
library(sdm)
library(tidyverse) # data tidying
library(sf) # spatial data compliant with tidyverse
library(raster) # raster data
library(here)
source(here::here('scripts/sdm_functions.R'))
set.seed(12)
names_vec <- c('PCL_MAN','PCL_SE1','PCL_SE2','PCL_SE3','PCM_BFP','PCM_CMD',
'PCM_DD5', 'PCM_MAP','PCM_PAS','PCM_TD','PCT_ECO','PCT_EFW',
'PLC_HRB', 'PLC_TRE', 'PLC_URB', 'PSL_BDR', 'PSL_CAR',
'PSL_PHO', 'PSL_SND','PSL_TUS','PSL_TWL','PTP_ELV','PTP_RLV',
'PTP_SLP','PTP_WET','PTP_ASP','PTP_SOL', 'PCL_MRA','PSW_DIS',
'PSW_OCC','PCO_XSC', 'PCO_YSC')
WPDPV <- raster::stack("/hdd/Geospatial_data/Western_Plant_Predictors/SoRo_wppr_vers_two.tif")
names(WPDPV) <- names_vec
target <- c(2, 4,9, 10, 13, 14, 16, 19, 20, 23, 24, 25, 26, 27, 29, 30)
target_ml <- c(1:10, 13:14, 16:20, 22:30)
WPDPV2 <- WPDPV[[(target)]]
WPDPV1 <- WPDPV[[(target_ml)]]
geo_proj = crs(WPDPV)
rm(WPDPV, target, target_ml, names_vec)
PA_ML_DF <- read_sf(here("data/processed/Pseudo_absences_ML_PREDICTED.shp"))
PA_ML_DF %>% pull(binomial) %>% unique()
PA_ML_DF1 <- split(PA_ML_DF, ~ binomial)
rm(PA_ML_DF)
Sys.time()
lapply(PA_ML_DF1[16:45], Machine_SDM) # skipped #3 & # 112
Sys.time()
Sys.time()
lapply(PA_ML_DF1[46:75], Machine_SDM) # skipped #3 & # 112
Sys.time()
knitr::opts_chunk$set(
echo = FALSE,
message = FALSE,
warning = FALSE
)
library(tidyverse)
library(here)
library(janitor)
library(sf)
blm_admnu <- st_read(paste0(here(), '/data/raw/blm_co_admu_fo_shp/',
list.files(paste0(here(), '/data/raw/blm_co_admu_fo_shp'), pattern = '.shp$')),
quiet = T)
cnty_rds <- st_read(paste0(here(), '/data/processed/UFO_roads.shp'), quiet =T)
library(tidyverse)
library(here)
library(FedData)
library(sf)
library(terra)
library(whitebox)
#set_here('..')
cnty_rds <- st_read(paste0(here(), '/data/processed/UFO_roads.shp'), quiet =T)
pts <- st_read(paste0(here(), '/data/raw/AIM_Points_2022.shp')) %>%
st_transform(26912)
cnty_rds <- st_transform(cnty_rds, 26912) %>%
group_by(FULLNAME) %>%
summarize(geometry = st_union(geometry))
cnty_rds <- st_transform(cnty_rds, 26912) %>%
group_by(FULLNAME) %>%
summarize(geometry = st_union(geometry))
nty_rds <- st_transform(cnty_rds, 26912) %>%
group_by(FULLNAME) %>%
summarize(geometry = st_union(geometry))
cnty_rds <- st_read(paste0(here(), '/data/processed/UFO_roads.shp'), quiet =T)
cnty_rds1 <- st_transform(cnty_rds, 26912) %>%
group_by(FULLNAME) %>%
summarize(geometry = st_union(geometry))
cnty_rds1 <- st_transform(cnty_rds, 26912) %>%
group_by(FULLNAME) %>%
summarize(geometry = st_union(geometry))
res <- st_nearest_feature(pts, cnty_rds)
res <- st_nearest_feature(pts, cnty_rds1)
closest_rds <- cnty_rds1[res,]
ggplot(pts) +
geom_sf() +
geom_sf(data = closest_rds) #+
ggplot(pts) +
geom_sf() +
geom_sf(data = closest_rds, color = 'blue') #+
head(cnty_rds)
head(cnty_rds1)
print(cnty_rds1)
res <- st_nearest_feature(pts, cnty_rds)
pts <- st_read(paste0(here(), '/data/raw/AIM_Points_2022.shp'))
res <- st_nearest_feature(pts, cnty_rds)
pts <- st_read(paste0(here(), '/data/raw/AIM_Points_2022.shp')) %>%
st_transform(st_crs(cnty_rds))
res <- st_nearest_feature(pts, cnty_rds)
closest_rds <- cnty_rds[res,]
distances <- st_distance(pts, cnty_rds[res,], by_element = TRUE)
np_linestrings <- st_nearest_points(pts, closest_rds, pairwise = TRUE)
ggplot(pts) +
geom_sf() +
geom_sf(data = closest_rds, color = 'blue') +
geom_sf(data = np_linestrings, color = 'red')
cnty_rds1 <- st_transform(cnty_rds, 26912) %>%
group_by(FULLNAME) %>%
summarize(geometry = st_union(geometry)) %>%
st_cast('LINESTRING')
View(cnty_rds1)
cnty_rds1 <- st_transform(cnty_rds, 26912) %>%
group_by(FULLNAME) %>%
summarize(geometry = st_union(geometry)) %>%
st_cast('MULTILINESTRING')
ggplot() +
geom_sf(data = cnty_rds1, color = 'red')+
geom_sf(data = cnty_rds, color = 'blue')
ggplot() +
geom_sf(data = cnty_rds, color = 'blue') +
geom_sf(data = cnty_rds1, color = 'red')
res_fuck <- st_intersects(closest_rds, cnty_rds1)
st_crs(cnty_rds1)
cnty_rds1 <- st_transform(cnty_rds, 26912) %>%
group_by(FULLNAME) %>%
summarize(geometry = st_union(geometry)) %>%
st_cast('MULTILINESTRING') %>%
st_transform(st_crs(closest_rds))
cnty_rds1 <- st_transform(cnty_rds, 26912) %>%
group_by(FULLNAME) %>%
summarize(geometry = st_union(geometry)) %>%
st_cast('MULTILINESTRING') %>%
st_transform(st_crs(closest_rds))
es_fuck <- st_intersects(closest_rds, cnty_rds1)
View(es_fuck)
res_fuck <- st_intersects(closest_rds, cnty_rds1) %>% unlist()
cnty_rds1[res_fuck]
cnty_rds1 <- cnty_rds1[res_fuck,]
ggplot(pts) +
geom_sf() +
geom_sf(data = closest_rds, color = 'blue') +
geom_sf(data = cnty_rds1, color = 'black') +
geom_sf(data = np_linestrings, color = 'red')
View(cnty_rds1)
View(es_fuck)
cnty_rds1 <- cnty_rds1[es_fuck,]
cnty_rds1 <- cnty_rds1[res_fuck,]
ggplot(pts) +
geom_sf() +
geom_sf(data = closest_rds, color = 'blue') +
geom_sf(data = cnty_rds1, color = 'black') +
geom_sf(data = np_linestrings, color = 'red')
res_fuck <- st_intersects(cnty_rds1, closest_rds) %>% unlist()
cnty_rds1 <- cnty_rds1[res_fuck,]
ggplot(pts) +
geom_sf() +
geom_sf(data = closest_rds, color = 'blue') +
geom_sf(data = cnty_rds1, color = 'black') +
geom_sf(data = np_linestrings, color = 'red')
res_fuck <- st_intersects(closest_rds, cnty_rds1) %>% unlist()
res_fuck <- st_intersects(closest_rds, cnty_rds1) %>% unlist()
cnty_rds1 <- cnty_rds1[res_fuck,]
res_fuck <- st_intersects(closest_rds, cnty_rds1) # %>% unlist()
View(closest_rds)
View(res_fuck)
res_fuck[[1]]
View(closest_rds)
ggplot(pts) +
geom_sf() +
geom_sf(data = closest_rds, color = 'blue')# +
View(res_fuck)
res_fuck <- st_touches(closest_rds, cnty_rds1) # %>% unlist()
